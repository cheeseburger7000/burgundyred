# burgundyred需求分析

勃艮第红是一款基于SpringBoot + Dubbo构建的B2C红酒主题商场。

[TOC]

## 环境

### 拦截器
- 前台拦截器
- 后台拦截器

### 异常捕获
- 前台捕获机
- 后台捕获器

### redis
1. 缓存
2. 分布式锁
3. 高可用

### 消息队列
1. 添加商品同步索引库
2. 邮件服务
3. 同步缓存


不使用分布式事务，使用最终一致性。

## 基础微服务
- 商品类目服务 t_category
- 商品服务 t_product
- 购物车服务 t_cart
- 订单服务 t_order t_order_item
- 支付服务 t_pay_info
- 搜索服务 elasticsearch
- 轮播图服务 t_banner
- 物流服务 t_shopping
- 用户服务 t_user
- 邮件服务 rabbitmq_listener
- 消息队列服务
    - 短信交换机
    - 订单
    - 索引库


## 前台-买家端应用

服务端渲染：模板引擎Thymeleaf + CSS/DIV定宽布局 + JQuery

客户端发送HTTP请求，服务端响应HTML数据

### 页面

1. 主页
2. 登录注册页面
3. 购物车
4. 订单列表
5. 个人中心页面
6. 商品展示页面
7. 商品搜索页面

### 1.门户服务

#### 1.1.网站主页

请求类型：HTTP请求，HTML响应

model数据：
- 用户
- 轮播图
- 产品类目列表
- 产品阶梯榜
    1. 1F 最新款式
    2. 2F 推荐款式
    3. 3F 亲民款式
    4. 4F 稀缺款式
    5. 5F 清仓甩卖

页面：index

使用缓存优化：将从数据库获取轮播图，产品类目列表和产品阶梯榜数据封装成一个基础服务。上层服务调用时，先从缓存中取数据，若缓存中不存在数据再去调用基础服务到数据库中拉取。

### 2.商品服务

#### 2.1.查询商品详情

请求类型：HTTP请求，HTML响应

请求参数：productId

页面：detail

优化：
- redis：缓存
- 消息队列：同步缓存

#### 2.2.按分类获取商品展示列表

请求类型：HTTP请求，HTML响应

请求参数：categoryId

model数据：
- productItemVo
- pageNum
- totalPage
- totalRecord

页面：list

#### *2.3.搜索商品

请求类型：HTTP请求，HTML响应

请求参数：keyword

页面：list

### 3.购物车服务

#### 3.1.用户获取购物车

请求类型：HTTP请求，HTML响应

响应：cart+cartitem

#### 3.2.添加商品到购物车

请求类型：Ajax请求，JSON响应

#### 3.3.inc/dec购物车商品数量

请求类型：Ajax请求，JSON响应

#### 3.4.清空购物车

请求类型：Ajax请求，JSON响应

### 4.订单服务

#### 4.1.创建订单

#### 4.2.支付订单

#### 4.3.支付回调

#### 4.4.查询订单状态

#### 4.5.取消订单

判断订单状态机 防止越权访问

#### 4.6.获取用户订单列表

#### 4.7.根据订单id查询订单详情

#### 4.8.收货

### 5.鉴权服务

#### 5.1.注册

#### 5.2.账户激活

#### 5.3.登录

#### 5.4.登出

### 6.个人中心服务

## 后台-卖家端应用

前后端分离：响应式Bootstrap + Vue

客户端发送Ajax请求，服务端响应JSON数据

### 页面

1. 搭建Vue路由

### 1.内容管理

#### 1.1.轮播图

##### 1.加轮播图

```java
public Class Banner {
    private String id;
    private String name;
    private String path;
    private Boolean active;
    private Date createTime;
}
```

七牛云图片上传


##### 2.轮播图列表

增加, 应用

前端样式参考阿里云防火墙页面

注意：个数问题

##### 3.激活轮播图

##### 4.取消激活轮播图

#### 1.2.商品类目列表

##### 1.商品类目列表

##### 2.添加商品类目

##### 3.热门商品类目

##### 4.取消热门商品类目

### 2.用户管理

#### 2.1.所有用户列表

#### 2.2.冻结用户

#### 2.3.恢复用户正常状态

### 3.商品管理

#### 3.1.增加商品

#### 3.2.所有商品列表

#### 3.3.上架商品

#### 3.4.下架商品

#### *3.4.补充库存

### 4.订单管理

#### 4.1.所有订单列表

#### 4.2.发货

#### 4.3.确认取消订单

### 5.管理员认证